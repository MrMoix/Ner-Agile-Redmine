Â	
pC:\Users\Baptiste\Documents\HES SO Valais\56 Software industrialization\Ner-Agile-Redmine\DAL\IInstallationDB.cs
	namespace 	
DAL
 
{ 
public 

	interface 
IInstallationDB $
{ 
int 
AddInstallation 
( 
string "
street# )
,) *
int+ .
number/ 5
,5 6
int7 :
postcode; C
,C D
stringE K
cityL P
,P Q
stringR X
energyY _
,_ `
stringa g
integrationh s
,s t
stringu {
pvCells	| ƒ
,
ƒ „
double
… ‹
orientation
Œ —
,
— ˜
double
™ Ÿ
roof
  ¤
,
¤ ¥
double
¦ ¬
length
­ ³
,
³ ´
double
µ »
width
¼ Á
,
Á Â
double
Ã É
area
Ê Î
)
Î Ï
;
Ï Ð
Installation -
!getInstallationByRegisteredNumber 6
(6 7
int7 :
registrationNumber; M
)M N
;N O
}		 
}

 Ö^
oC:\Users\Baptiste\Documents\HES SO Valais\56 Software industrialization\Ner-Agile-Redmine\DAL\InstallationDB.cs
	namespace

 	
DAL


 
{ 
public 

class 
InstallationDB 
:  !
IInstallationDB" 1
{ 
private 
IConfiguration 
Configuration ,
{- .
get/ 2
;2 3
}4 5
private 
String 
ConnectionString '
{( )
get* -
;- .
}/ 0
public 
InstallationDB 
( 
IConfiguration ,
configuration- :
): ;
{ 	
Configuration 
= 
configuration )
;) *
ConnectionString 
= 
Configuration ,
., -
GetConnectionString- @
(@ A
$strA O
)O P
;P Q
} 	
public 
Installation -
!getInstallationByRegisteredNumber =
(= >
int> A
registrationNumberB T
)T U
{ 	
Installation 
installation %
=& '
null( ,
;, -
try 
{ 
using 
( 
SqlConnection $
cn% '
=( )
new* -
SqlConnection. ;
(; <
ConnectionString< L
)L M
)M N
{   
string!! 
query!!  
=!!! "
$str!!# n
;!!n o

SqlCommand"" 
cmd"" "
=""# $
new""% (

SqlCommand"") 3
(""3 4
query""4 9
,""9 :
cn""; =
)""= >
;""> ?
cmd## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 E
,##E F
registrationNumber##G Y
)##Y Z
;##Z [
cn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
using'' 
('' 
SqlDataReader'' (
dr'') +
='', -
cmd''. 1
.''1 2
ExecuteReader''2 ?
(''? @
)''@ A
)''A B
{(( 
if)) 
()) 
dr)) 
.)) 
Read)) #
())# $
)))$ %
)))% &
{** 
installation++ (
=++) *
new+++ .
Installation++/ ;
(++; <
)++< =
;++= >
installation,, (
.,,( )
RegistrationNumber,,) ;
=,,< =
(,,> ?
int,,? B
),,B C
dr,,C E
[,,E F
$str,,F Z
],,Z [
;,,[ \
if.. 
(..  
dr..  "
[.." #
$str..# +
]..+ ,
!=..- /
DBNull..0 6
...6 7
Value..7 <
)..< =
installation//  ,
.//, -
Street//- 3
=//4 5
(//6 7
string//7 =
)//= >
dr//> @
[//@ A
$str//A I
]//I J
;//J K
if00 
(00  
dr00  "
[00" #
$str00# +
]00+ ,
!=00- /
DBNull000 6
.006 7
Value007 <
)00< =
installation11  ,
.11, -
Number11- 3
=114 5
(116 7
int117 :
)11: ;
dr11; =
[11= >
$str11> F
]11F G
;11G H
if22 
(22  
dr22  "
[22" #
$str22# -
]22- .
!=22/ 1
DBNull222 8
.228 9
Value229 >
)22> ?
installation33  ,
.33, -
Postcode33- 5
=336 7
(338 9
int339 <
)33< =
dr33= ?
[33? @
$str33@ J
]33J K
;33K L
if44 
(44  
dr44  "
[44" #
$str44# )
]44) *
!=44+ -
DBNull44. 4
.444 5
Value445 :
)44: ;
installation55  ,
.55, -
City55- 1
=552 3
(554 5
String555 ;
)55; <
dr55< >
[55> ?
$str55? E
]55E F
;55F G
if66 
(66  
dr66  "
[66" #
$str66# +
]66+ ,
!=66- /
DBNull660 6
.666 7
Value667 <
)66< =
installation77  ,
.77, -
Energy77- 3
=774 5
(776 7
String777 =
)77= >
dr77> @
[77@ A
$str77A I
]77I J
;77J K
if88 
(88  
dr88  "
[88" #
$str88# 0
]880 1
!=882 4
DBNull885 ;
.88; <
Value88< A
)88A B
installation99  ,
.99, -
Integration99- 8
=999 :
(99; <
String99< B
)99B C
dr99C E
[99E F
$str99F S
]99S T
;99T U
if:: 
(::  
dr::  "
[::" #
$str::# ,
]::, -
!=::. 0
DBNull::1 7
.::7 8
Value::8 =
)::= >
installation;;  ,
.;;, -
PVCells;;- 4
=;;5 6
(;;7 8
string;;8 >
);;> ?
dr;;? A
[;;A B
$str;;B K
];;K L
;;;L M
if<< 
(<<  
dr<<  "
[<<" #
$str<<# 5
]<<5 6
!=<<7 9
DBNull<<: @
.<<@ A
Value<<A F
)<<F G
installation==  ,
.==, -
FieldOrientation==- =
===> ?
(==@ A
double==A G
)==G H
dr==H J
[==J K
$str==K ]
]==] ^
;==^ _
if>> 
(>>  
dr>>  "
[>>" #
$str>># -
]>>- .
!=>>/ 1
DBNull>>2 8
.>>8 9
Value>>9 >
)>>> ?
installation??  ,
.??, -
SlopRoof??- 5
=??6 7
(??8 9
double??9 ?
)??? @
dr??@ B
[??B C
$str??C M
]??M N
;??N O
if@@ 
(@@  
dr@@  "
[@@" #
$str@@# +
]@@+ ,
!=@@- /
DBNull@@0 6
.@@6 7
Value@@7 <
)@@< =
installationAA  ,
.AA, -
LengthAA- 3
=AA4 5
(AA6 7
doubleAA7 =
)AA= >
drAA> @
[AA@ A
$strAAA I
]AAI J
;AAJ K
ifBB 
(BB  
drBB  "
[BB" #
$strBB# *
]BB* +
!=BB, .
DBNullBB/ 5
.BB5 6
ValueBB6 ;
)BB; <
installationCC  ,
.CC, -
WidthCC- 2
=CC3 4
(CC5 6
doubleCC6 <
)CC< =
drCC= ?
[CC? @
$strCC@ G
]CCG H
;CCH I
ifDD 
(DD  
drDD  "
[DD" #
$strDD# )
]DD) *
!=DD+ -
DBNullDD. 4
.DD4 5
ValueDD5 :
)DD: ;
installationEE  ,
.EE, -
AreaEE- 1
=EE2 3
(EE4 5
doubleEE5 ;
)EE; <
drEE< >
[EE> ?
$strEE? E
]EEE F
;EEF G
}FF 
}GG 
}HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
eJJ 
)JJ 
{KK 
throwLL 
eLL 
;LL 
}MM 
returnNN 
installationNN 
;NN  
}OO 	
publicRR 
intRR 
AddInstallationRR "
(RR" #
StringRR# )
streetRR* 0
,RR0 1
intRR2 5
numberRR6 <
,RR< =
intRR> A
postcodeRRB J
,RRJ K
StringRRL R
cityRRS W
,RRW X
StringRRY _
energyRR` f
,RRf g
StringRRh n
integrationRRo z
,RRz {
StringSS 
pvCellsSS 
,SS 
doubleSS "
orientationSS# .
,SS. /
doubleSS0 6
roofSS7 ;
,SS; <
doubleSS= C
lengthSSD J
,SSJ K
doubleSSL R
widthSSS X
,SSX Y
doubleSSZ `
areaSSa e
)SSe f
{TT 	
intWW 
resultWW 
=WW 
$numWW 
;WW 
tryYY 
{ZZ 
using[[ 
([[ 
SqlConnection[[ $
cn[[% '
=[[( )
new[[* -
SqlConnection[[. ;
([[; <
ConnectionString[[< L
)[[L M
)[[M N
{\\ 
string]] 
query]]  
=]]! "
$str	]]# ®
+
]]¯ °
$str	^^ £
;
^^£ ¤

SqlCommand__ 
cmd__ "
=__# $
new__% (

SqlCommand__) 3
(__3 4
query__4 9
,__9 :
cn__; =
)__= >
;__> ?
cmd`` 
.`` 

Parameters`` "
.``" #
AddWithValue``# /
(``/ 0
$str``0 9
,``9 :
street``; A
)``A B
;``B C
cmdaa 
.aa 

Parametersaa "
.aa" #
AddWithValueaa# /
(aa/ 0
$straa0 9
,aa9 :
numberaa; A
)aaA B
;aaB C
cmdbb 
.bb 

Parametersbb "
.bb" #
AddWithValuebb# /
(bb/ 0
$strbb0 ;
,bb; <
postcodebb= E
)bbE F
;bbF G
cmdcc 
.cc 

Parameterscc "
.cc" #
AddWithValuecc# /
(cc/ 0
$strcc0 7
,cc7 8
citycc9 =
)cc= >
;cc> ?
cmddd 
.dd 

Parametersdd "
.dd" #
AddWithValuedd# /
(dd/ 0
$strdd0 9
,dd9 :
energydd; A
)ddA B
;ddB C
cmdee 
.ee 

Parametersee "
.ee" #
AddWithValueee# /
(ee/ 0
$stree0 >
,ee> ?
integrationee@ K
)eeK L
;eeL M
cmdff 
.ff 

Parametersff "
.ff" #
AddWithValueff# /
(ff/ 0
$strff0 :
,ff: ;
pvCellsff< C
)ffC D
;ffD E
cmdgg 
.gg 

Parametersgg "
.gg" #
AddWithValuegg# /
(gg/ 0
$strgg0 >
,gg> ?
orientationgg@ K
)ggK L
;ggL M
cmdhh 
.hh 

Parametershh "
.hh" #
AddWithValuehh# /
(hh/ 0
$strhh0 7
,hh7 8
roofhh9 =
)hh= >
;hh> ?
cmdii 
.ii 

Parametersii "
.ii" #
AddWithValueii# /
(ii/ 0
$strii0 9
,ii9 :
lengthii; A
)iiA B
;iiB C
cmdjj 
.jj 

Parametersjj "
.jj" #
AddWithValuejj# /
(jj/ 0
$strjj0 8
,jj8 9
widthjj: ?
)jj? @
;jj@ A
cmdkk 
.kk 

Parameterskk "
.kk" #
AddWithValuekk# /
(kk/ 0
$strkk0 7
,kk7 8
areakk9 =
)kk= >
;kk> ?
cnnn 
.nn 
Opennn 
(nn 
)nn 
;nn 
resultpp 
=pp 
Convertpp $
.pp$ %
ToInt32pp% ,
(pp, -
cmdpp- 0
.pp0 1
ExecuteScalarpp1 >
(pp> ?
)pp? @
)pp@ A
;ppA B
}rr 
}ss 
catchtt 
(tt 
	Exceptiontt 
ett 
)tt 
{uu 
throwvv 
evv 
;vv 
}ww 
returnxx 
resultxx 
;xx 
}yy 	
}{{ 
}|| 